<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Federation Sun Archive</title>
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Anton&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400&display=swap" rel="stylesheet">

<style>
:root { --ticker-distance: 0px; --ticker-duration: 20s; }
html, body {
  margin: 0;
  font-family: 'Bebas Neue', sans-serif;
  background: #1e1e1e;
  color: white;
  box-sizing: border-box;
  overflow-x: hidden;
}
body {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  padding: 0;
}
img { max-width: 100%; height: auto; display: block; }

/* Banner Styles */
.banner {
  position: fixed;
  top: 0; left: 0; right: 0;
  background: #1e1e1e;
  box-shadow: 0 2px 4px rgba(0,0,0,0.4);
  z-index: 1000;
}
.banner-content {
  display: grid;
  grid-template-columns: 1fr auto 1fr;
  grid-template-areas: "social logo search";
  align-items: center;
  max-width: 1200px;
  margin: 0 auto;
  padding: 12px 0;
  column-gap: 8px;
}
.social-section {
  grid-area: social;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 4px;
}
.time-subsection {
  font-size: 13px;
  line-height: 1;
  text-align: left;
  display: block;
}
.icons-subsection {
  display: flex;
  gap: 8px;
  align-items: center;
}
.icons-subsection img {
  height: 24px;
  width: auto;
}
.left-section {
  grid-area: logo;
  display: flex;
  justify-content: center;
}
.left-section img.logo {
  height: 53px;
  width: auto;
}
.center-section {
  grid-area: search;
  display: flex;
  justify-self: end;
  gap: 6px;
  max-width: 300px;
  width: 100%;
}
.center-section form {
  display: flex;
  width: 100%;
  gap: 6px;
}
.center-section input[type="text"] {
  flex: 1;
  height: 32px;
  padding: 4px 8px;
  font-size: 15px;
  border: none;
  border-radius: 4px;
  outline: none;
  background: #fff;
  color: #1e1e1e;
  box-sizing: border-box;
}
.center-section button {
  background-image: url('australian_flag.png');
  background-size: cover;
  background-repeat: no-repeat;
  background-position: center;
  border: 1px solid white;
  border-radius: 4px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  height: 32px;
  padding: 0 12px;
  box-sizing: border-box;
  color: white;
  font-size: 15px;
  font-weight: bold;
  text-transform: uppercase;
  text-shadow:
    -1px -1px 0 #1e1e1e,
     1px -1px 0 #1e1e1e,
    -1px  1px 0 #1e1e1e,
     1px  1px 0 #1e1e1e;
}

/* Ticker */
.ticker {
  width: 100%;
  overflow: hidden;
  height: 32px;
  position: relative;
  z-index: 999;
}
.ticker-inner {
  width: 100%;
  max-width: 1200px;
  margin: 0 auto;
  background: #222;
  border-top: 1px solid #444;
  border-bottom: 1px solid #444;
  display: flex;
  align-items: center;
  height: 32px;
  overflow: hidden;
}
.ticker-track {
  display: flex;
  will-change: transform;
  animation: scroll var(--ticker-duration) linear infinite;
  width: max-content;
}
.ticker-group {
  display: flex;
  white-space: nowrap;
}
.ticker-group a {
  color: white;
  text-decoration: none;
  font-size: 15px;
  margin-right: 40px;
  display: inline-block;
}
.ticker-group a:hover {
  color: gold;
}
@keyframes scroll {
  from { transform: translateX(0); }
  to   { transform: translateX(calc(-1 * var(--ticker-distance))); }
}

.main-headline-wrapper {
  padding-top: calc(53px + 32px + 12px + 10px + 20px);
}

/* Shared styles omitted for brevity—will be in Part 2 */
</style>
</head>
<body>
<div class="banner">
  <div class="banner-content">
    <div class="social-section">
      <div class="time-subsection">
        <div id="current-time">--:-- AEST</div>
        <div id="current-date">--/--/----</div>
      </div>
      <div class="icons-subsection">
        <!-- Social icons (same as homepage) -->
        <a href="https://gab.com/federationsun" target="_blank"><img src="icon_gab.png" alt="Gab"></a>
        <a href="https://www.facebook.com/people/Federation-Sun/61577319796033/" target="_blank"><img src="icon_facebook.png" alt="Facebook"></a>
        <a href="https://www.instagram.com/fedsun.news/" target="_blank"><img src="icon_instagram.png" alt="Instagram"></a>
        <a href="https://fedsun.news/feed.xml" target="_blank"><img src="icon_rss.png" alt="RSS"></a>
        <a href="https://t.me/federationsun" target="_blank"><img src="icon_telegram.png" alt="Telegram"></a>
        <a href="https://x.com/federationsun" target="_blank"><img src="icon_x.png" alt="X"></a>
        <a href="https://www.youtube.com/channel/UCe8DBHr28mOCBxtZuxzJ7_A" target="_blank"><img src="icon_youtube.png" alt="YouTube"></a>
      </div>
    </div>
    <div class="left-section">
      <a href="https://fedsun.news">
        <img src="fedsun_logo_hoz.png" alt="Logo" class="logo">
      </a>
    </div>
    <div class="center-section">
      <form id="search-form" autocomplete="off">
        <input type="text" id="search-input" placeholder="Search...">
        <button type="submit" class="button-flag">Search</button>
      </form>
    </div>
  </div>
  <div class="ticker">
    <div class="ticker-inner" id="ticker-inner">
      <div class="ticker-track" id="ticker-track">Loading headlines…</div>
    </div>
  </div>
</div>
<div class="container">
<div id="search-filters"></div>
<div id="search-results"></div>
<div id="search-pagination"></div>
<div class="main-headline-wrapper">
  <div class="main-headline-layout">
    <div class="main-headline-left">
      <a href="#" class="main-headline-link">ARCHIVED</a>
      <div class="two-columns-below">
        <div class="column" id="latest-headlines"></div>
        <div class="column" id="more-headlines-list"></div>
      </div>
    </div>
    <div class="right-column" id="right-column-1"></div>
  </div>
</div>
</div> <!-- end container -->

<hr class="footer-separator" />
<footer>
  <div class="footer-wrapper">
    <div class="footer-content">
      <div class="footer-section left">
        <img src="australian_flag.png" alt="Australian Flag" />
        <p>
          The Federation Sun proudly honours the European Australians who built this nation—taming the land, founding our cities, and instilling the traditions and institutions of Western civilisation that shaped Australia. We stand firm in our heritage and look ahead with unity and purpose to secure a strong future for our people.
        </p>
      </div>
      <div class="footer-section center">
        <a href="https://fedsun.news">
          <img src="fedsun__logo_footer.png" alt="Federation Sun Logo" />
        </a>
        <p>
          Contact:<br />
          editor@fedsun.news
        </p>
        <p>The Federation Sun © 2025</p>
      </div>
      <div class="footer-section right">
        <h3>SEND NEWS TIPS</h3>
        <form action="https://formspree.io/f/meokpdkj" method="POST">
          <textarea name="tip" placeholder="Type your tip here..."></textarea>
          <input type="hidden" name="_redirect" value="https://fedsun.news/thanks.html" />
          <button type="submit" class="button-flag">Send tip</button>
        </form>
      </div>
    </div>
  </div>
</footer>

<style>
/* Additional styles matching homepage */

/* Make all text normal weight and uppercase in headers/footers */
body, body * {
  font-weight: normal !important;
}
.banner,
.banner * {
  text-transform: uppercase;
  font-family: 'Oswald', sans-serif;
}
.footer-wrapper,
.footer-wrapper * {
  text-transform: uppercase;
  font-family: 'Oswald', sans-serif;
}

/* Headline styles */
.two-columns-below a,
.right-column a,
.main-headline-link {
  text-transform: uppercase;
  font-family: 'Oswald', sans-serif;
  text-decoration: none;
}
.ticker-group a {
  text-transform: uppercase;
  font-family: 'Oswald', sans-serif;
}

/* Hover color */
.two-columns-below a:hover,
.right-column a:hover {
  color: gold !important;
}

/* Headline description font */
.headline-description {
  font-family: 'Roboto', sans-serif;
  font-size: 14px;
  line-height: 1.4;
}

/* Footer flag image limit on desktop */
@media (min-width: 769px) {
  .footer-section.left img {
    max-width: 100px;
    width: 100%;
  }
}
.footer-section.left p,
.footer-section.center p {
  text-transform: none;
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .container {
    padding-top: 155px;
  }
}
</style>

<script>
function updateTime() {
  const now = new Date();
  const t = new Intl.DateTimeFormat('en-AU', {
    timeZone: 'Australia/Melbourne',
    hour: '2-digit', minute: '2-digit', hour12: false
  }).format(now);
  const d = new Intl.DateTimeFormat('en-AU', {
    timeZone: 'Australia/Melbourne',
    weekday: 'short', year: 'numeric', month: '2-digit', day: '2-digit'
  }).format(now);
  document.getElementById('current-time').textContent = t + ' AEST';
  document.getElementById('current-date').textContent = d;
}
updateTime();
setInterval(updateTime, 60000);

// Format date
function formatDateAEST(dateStr) {
  const date = new Date(dateStr);
  return new Intl.DateTimeFormat('en-AU', {
    timeZone: 'Australia/Sydney',
    weekday: 'short',
    year: 'numeric',
    month: 'short',
    day: '2-digit',
    hour: '2-digit',
    minute: '2-digit',
    hour12: false
  }).format(date) + ' AEST';
}

// Create headline item
function createHeadlineItem(item) {
  const wrapper = document.createElement('div');
  wrapper.className = 'headline-item';
  wrapper.style.display = 'flex';
  wrapper.style.gap = '10px';
  wrapper.style.alignItems = 'flex-start';

  const img = document.createElement('img');
  img.src = item.image;
  img.alt = item.title;
  img.style.width = '33%';
  img.style.aspectRatio = '16/9';
  img.style.objectFit = 'cover';
  img.style.flexShrink = '0';

  const content = document.createElement('div');
  content.style.flex = '1';
  content.style.textAlign = 'left';

  const link = document.createElement('a');
  link.href = item.url;
  link.textContent = item.title;
  link.style.color = 'white';
  link.style.display = 'block';
  link.style.marginBottom = '4px';

  const meta = document.createElement('div');
  meta.style.fontSize = '12px';
  meta.style.color = '#ccc';
  meta.textContent = `${formatDateAEST(item.date)}${item.author ? ' — ' + item.author : ''}`;

  const desc = document.createElement('div');
  desc.className = 'headline-description';
  desc.textContent = item.description || '';

  content.appendChild(link);
  content.appendChild(meta);
  content.appendChild(desc);

  wrapper.appendChild(img);
  wrapper.appendChild(content);
  return wrapper;
}

// Ticker from headlines.json
fetch('/data/headlines.json?' + new Date().getTime())
.then(r => r.json())
.then(data => {
  const today = new Date();
  const recent = data.filter(item => {
    const d = new Date(item.date);
    const diff = (today - d) / (1000 * 60 * 60 * 24);
    return diff <= 7;
  });

  const track = document.getElementById('ticker-track');
  track.innerHTML = '';
  const grp = document.createElement('div');
  grp.className = 'ticker-group';
  recent.forEach(item => {
    const a = document.createElement('a');
    a.href = item.url;
    a.textContent = item.title;
    grp.appendChild(a);
  });
  track.appendChild(grp);
  track.appendChild(grp.cloneNode(true));
  const dist = grp.offsetWidth, speed = 20;
  document.documentElement.style.setProperty('--ticker-distance', dist + 'px');
  document.documentElement.style.setProperty('--ticker-duration', (dist / speed) + 's');
})
.catch(e => console.error('Ticker fetch error:', e));

// Load archive.json headlines
fetch('/data/archive.json?' + new Date().getTime())
.then(r => r.json())
.then(data => {
  const col1 = document.getElementById('latest-headlines');
  const col2 = document.getElementById('more-headlines-list');
  const col3 = document.getElementById('right-column-1');
  [col1, col2, col3].forEach(c => c.innerHTML = '');

  const perCol = Math.ceil(data.length / 3);
  [col1, col2, col3].forEach((col, i) => {
    data.slice(i * perCol, (i + 1) * perCol).forEach(item => {
      col.appendChild(createHeadlineItem(item));
    });
  });
  // ✅ Add Back to Homepage link
  const backLinkWrapper = document.createElement('div');
  backLinkWrapper.style.textAlign = 'center';
  backLinkWrapper.style.marginTop = '20px';

  const backLink = document.createElement('a');
  backLink.href = 'https://fedsun.news/';
  backLink.textContent = 'Back to Homepage...';
  backLink.style.color = 'white';
  backLink.style.textDecoration = 'none';
  backLink.style.fontSize = '18px';

  backLink.addEventListener('mouseover', () => {
    backLink.style.color = 'gold';
  });
  backLink.addEventListener('mouseout', () => {
    backLink.style.color = 'white';
  });

  backLinkWrapper.appendChild(backLink);
  col3.appendChild(backLinkWrapper);
})
.catch(e => console.error('Archive fetch error:', e));

// Search (same as homepage)
document.getElementById("search-form").addEventListener("submit", async function(e) {
  e.preventDefault();
  const query = document.getElementById("search-input").value.trim().toLowerCase();
  const resultsContainer = document.getElementById("search-results");
  const filtersContainer = document.getElementById("search-filters");
  const paginationContainer = document.getElementById("search-pagination");

  resultsContainer.innerHTML = "<p>Loading results...</p>";
  filtersContainer.innerHTML = "";
  paginationContainer.innerHTML = "";

  const res = await fetch('/data/headlines.json');
  const headlines = await res.json();

  let filtered = headlines.filter(item =>
    item.title.toLowerCase().includes(query) ||
    (item.description && item.description.toLowerCase().includes(query))
  );

  if (filtered.length === 0) {
    resultsContainer.innerHTML = "<p>No results found.</p>";
    return;
  }

  const uniqueDates = [...new Set(filtered.map(item => item.date.slice(0,10)))];
  if (uniqueDates.length > 1) {
    const select = document.createElement("select");
    select.innerHTML = `<option value="">Filter by date</option>` +
      uniqueDates.map(d => `<option value="${d}">${d}</option>`).join("");
    select.addEventListener("change", function() {
      const date = this.value;
      if (date) {
        filtered = filtered.filter(i => i.date.startsWith(date));
      } else {
        filtered = headlines.filter(item =>
          item.title.toLowerCase().includes(query) ||
          (item.description && item.description.toLowerCase().includes(query))
        );
      }
      renderPage(1);
    });
    filtersContainer.appendChild(select);
  }

  const itemsPerPage = 5;
  function renderPage(page) {
    const start = (page - 1) * itemsPerPage;
    const end = start + itemsPerPage;
    const pageItems = filtered.slice(start, end);

    resultsContainer.innerHTML = "";
    pageItems.forEach(item => {
      const wrapper = document.createElement("div");
      wrapper.style.borderBottom = "1px solid #444";
      wrapper.style.padding = "10px 0";
      wrapper.style.textAlign = "left";

      const titleLink = document.createElement("a");
      titleLink.href = item.url;
      titleLink.style.color = "white";
      titleLink.style.fontFamily = "'Oswald', sans-serif";
      titleLink.style.fontSize = "20px";
      titleLink.style.textDecoration = "none";
      titleLink.style.display = "block";
      titleLink.style.marginBottom = "4px";
      titleLink.innerHTML = item.title.replace(new RegExp(query, "gi"), match => `<span style="background:gold;color:black;">${match}</span>`);

      const desc = document.createElement("div");
      desc.style.fontSize = "14px";
      desc.style.color = "#ccc";
      desc.style.fontFamily = "'Roboto', sans-serif";
      desc.innerHTML = (item.description || "").replace(new RegExp(query, "gi"), match => `<span style="background:gold;color:black;">${match}</span>`);

      const meta = document.createElement("div");
      meta.style.fontSize = "12px";
      meta.style.color = "#aaa";
      meta.textContent = `Published: ${item.date.slice(0,10)}${item.author ? " — " + item.author : ""}`;

      wrapper.appendChild(titleLink);
      wrapper.appendChild(desc);
      wrapper.appendChild(meta);
      resultsContainer.appendChild(wrapper);
    });

    const totalPages = Math.ceil(filtered.length / itemsPerPage);
    paginationContainer.innerHTML = "";
    if (totalPages > 1) {
      for (let i=1; i<=totalPages; i++) {
        const btn = document.createElement("button");
        btn.textContent = i;
        btn.style.margin = "0 4px";
        btn.style.padding = "4px 8px";
        btn.style.background = "#333";
        btn.style.color = "white";
        btn.style.border = "1px solid #555";
        btn.style.cursor = "pointer";
        if (i === page) btn.style.background = "gold";
        btn.addEventListener("click", ()=>renderPage(i));
        paginationContainer.appendChild(btn);
      }
    }
  }
  renderPage(1);
});
</script>
</body>
</html>
